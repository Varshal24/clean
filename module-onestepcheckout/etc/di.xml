<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <!-- Preferences -->
    <preference for="Aheadworks\OneStepCheckout\Api\Data\CartItemOptionsDetailsInterface" type="Aheadworks\OneStepCheckout\Model\CartItemOptionsDetails" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\CartItemUpdateDetailsInterface" type="Aheadworks\OneStepCheckout\Model\CartItemUpdateDetails" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\DataFieldCompletenessInterface" type="Aheadworks\OneStepCheckout\Model\DataFieldCompleteness" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\CheckoutSectionsDetailsInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSectionsDetails" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\CheckoutSectionInformationInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSectionInformation" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\GiftMessageSectionInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSection\GiftMessage" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\GiftMessageConfigInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSection\GiftMessage\GiftMessageConfig" />
    <preference for="Aheadworks\OneStepCheckout\Api\Data\GiftMessageInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSection\GiftMessage\GiftMessageLevel" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestCartItemManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestCartItemManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestCartItemOptionsManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestCartItemOptionsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\CartItemManagementInterface" type="Aheadworks\OneStepCheckout\Model\CartItemManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\CartItemOptionsManagementInterface" type="Aheadworks\OneStepCheckout\Model\CartItemOptionsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestPaymentMethodsManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestPaymentMethodsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\PaymentMethodsManagementInterface" type="Aheadworks\OneStepCheckout\Model\PaymentMethodsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\NewsletterSubscriberManagementInterface" type="Aheadworks\OneStepCheckout\Model\NewsletterSubscriberManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\DataFieldCompletenessLoggerInterface" type="Aheadworks\OneStepCheckout\Model\DataFieldCompletenessLogger" />
    <preference for="Aheadworks\OneStepCheckout\Api\CheckoutSectionsManagementInterface" type="Aheadworks\OneStepCheckout\Model\CheckoutSectionsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestCheckoutSectionsManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestCheckoutSectionsManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\CustomerAddressManagementInterface" type="Aheadworks\OneStepCheckout\Model\CustomerAddressManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestGiftMessageItemManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestGiftMessageItemManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GiftMessageItemManagementInterface" type="Aheadworks\OneStepCheckout\Model\GiftMessageItemManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GuestGiftMessageManagementInterface" type="Aheadworks\OneStepCheckout\Model\GuestGiftMessageManagement" />
    <preference for="Aheadworks\OneStepCheckout\Api\GiftMessageManagementInterface" type="Aheadworks\OneStepCheckout\Model\GiftMessageManagement" />

    <!-- Plugins -->
    <type name="Magento\Checkout\Api\GuestPaymentInformationManagementInterface">
        <plugin name="aw-osc-add-customer-info" type="Aheadworks\OneStepCheckout\Plugin\Checkout\Model\GuestPaymentInformationPlugin"/>
    </type>
    <type name="Magento\Checkout\Api\PaymentInformationManagementInterface">
        <plugin name="aw-osc-add-customer-info" type="Aheadworks\OneStepCheckout\Plugin\Checkout\Model\PaymentInformationPlugin"/>
    </type>
    <type name="Magento\Quote\Api\Data\AddressInterface">
        <plugin name="aw_onestepcheckout_quote_address_interface_plugin" type="Aheadworks\OneStepCheckout\Plugin\Quote\Address"/>
    </type>
    <type name="Magento\Framework\View\Asset\Minification">
        <plugin name="aw-osc-core-minification-plugin" type="Aheadworks\OneStepCheckout\Plugin\View\Asset\Minification" />
    </type>
    <type name="Magento\Checkout\Api\TotalsInformationManagementInterface">
        <plugin name="aw_onestepcheckout_guest_totals_information_plugin" type="Aheadworks\OneStepCheckout\Plugin\Checkout\TotalsInformationPlugin"/>
    </type>
    <type name="Magento\Sales\Api\OrderRepositoryInterface">
        <plugin name="aw-osc-order-repository-plugin" type="Aheadworks\OneStepCheckout\Plugin\Order\OrderRepositoryPlugin"/>
    </type>
    <type name="Magento\Customer\Model\Address\Validator\General">
        <plugin name="aw-osc-address-validator-plugin" type="Aheadworks\OneStepCheckout\Plugin\Customer\AddressValidatorPlugin"/>
    </type>
    <type name="Magento\Checkout\Api\PaymentInformationManagementInterface">
        <plugin name="aw-osc-adjust-vault-payment-plugin"
                type="Aheadworks\OneStepCheckout\Plugin\Vault\PaymentVaultInformationManagement"/>
    </type>

    <!-- Disabling the plugin in order to properly work out Save in address book -->
    <type name="Magento\Checkout\Api\PaymentInformationManagementInterface">
        <plugin name="disable-place-order" type="Magento\CheckoutStaging\Plugin\PaymentInformationManagementPlugin" disabled="true"/>
    </type>

    <type name="Aheadworks\OneStepCheckout\Model\ResourceModel\Report\CheckoutBehavior">
        <arguments>
            <argument name="connectionName" xsi:type="string">checkout</argument>
        </arguments>
    </type>
    <type name="Magento\ScalableCheckout\Console\Command\SplitQuote">
        <arguments>
            <argument name="tables" xsi:type="array">
                <item name="aw_osc_checkout_data_completeness" xsi:type="string">aw_osc_checkout_data_completeness</item>
            </argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Source\Customization\CustomValidation">
        <arguments>
            <argument name="validations" xsi:type="array">
                <item name="vat_id" xsi:type="array">
                    <item name="vat-validation" xsi:type="string">VAT validation</item>
                </item>
            </argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\ThirdPartyModule\Braintree\ReCaptcha\ReCaptchaBraintreeCompositeProcessor">
        <arguments>
            <argument name="processors" xsi:type="array">
                <item name="paypal_recaptcha_braintree" xsi:type="object">Aheadworks\OneStepCheckout\Model\ThirdPartyModule\Braintree\ReCaptcha\Processors\Paypal</item>
                <item name="magento_recaptcha_braintree" xsi:type="object">Aheadworks\OneStepCheckout\Model\ThirdPartyModule\Braintree\ReCaptcha\Processors\Magento</item>
            </argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Product\ConfigurationPool">
        <arguments>
            <argument name="configurations" xsi:type="array">
                <item name="configurable" xsi:type="string">Aheadworks\OneStepCheckout\Model\Product\Configuration\Configurable</item>
            </argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Address\Form\Customization\Config">
        <arguments>
            <argument name="reader" xsi:type="object">Aheadworks\OneStepCheckout\Model\Address\Form\Customization\Config\Reader\Proxy</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Ui\DataProvider\CollectionFactory">
        <arguments>
            <argument name="collections" xsi:type="array">
                <item name="aw_osc_abandoned_checkout_report_listing_data_source" xsi:type="string">Aheadworks\OneStepCheckout\Model\ResourceModel\Report\AbandonedCheckout\Grid\Collection</item>
            </argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\ResourceModel\Report\AbandonedCheckout\Grid\Collection">
        <arguments>
            <argument name="mainTable" xsi:type="string">aw_osc_report_abandoned_checkouts_index</argument>
            <argument name="eventPrefix" xsi:type="string">aw_osc_abandoned_checkout_report_grid_collection</argument>
            <argument name="eventObject" xsi:type="string">abandoned_checkout_report_grid_collection</argument>
            <argument name="resourceModel" xsi:type="string">Aheadworks\OneStepCheckout\Model\ResourceModel\Report\AbandonedCheckout</argument>
        </arguments>
    </type>
    <virtualType name="AwOscReportGridFilterPool" type="Magento\Framework\View\Element\UiComponent\DataProvider\FilterPool">
        <arguments>
            <argument name="appliers" xsi:type="array">
                <item name="regular" xsi:type="object">Magento\Framework\View\Element\UiComponent\DataProvider\RegularFilter</item>
                <item name="fulltext" xsi:type="object">Magento\Framework\View\Element\UiComponent\DataProvider\FulltextFilter</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AwOscAbandonedCheckoutReportDataProvider" type="Aheadworks\OneStepCheckout\Ui\DataProvider">
        <arguments>
            <argument name="collection" xsi:type="object" shared="false">Aheadworks\OneStepCheckout\Model\ResourceModel\Report\AbandonedCheckout\Collection</argument>
            <argument name="filterPool" xsi:type="object" shared="false">AwOscReportGridFilterPool</argument>
            <argument name="reporting" xsi:type="object" shared="false">Aheadworks\OneStepCheckout\Ui\DataProvider\Reporting</argument>
        </arguments>
    </virtualType>
    <type name="Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilterPool">
        <arguments>
            <argument name="appliers" xsi:type="array">
                <item name="customer_group" xsi:type="object">Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilter\CustomerGroupId\Applier</item>
                <item name="date_range" xsi:type="object">Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilter\DateRange\Applier</item>
                <item name="store_id" xsi:type="object">Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilter\StoreId\Applier</item>
                <item name="store_group_id" xsi:type="object">Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilter\StoreGroupId\Applier</item>
                <item name="website_id" xsi:type="object">Aheadworks\OneStepCheckout\Ui\DataProvider\DefaultFilter\WebsiteId\Applier</item>
            </argument>
        </arguments>
    </type>
    <virtualType name="Magento\Sales\Model\ResourceModel\Order\Grid">
        <arguments>
            <argument name="columns" xsi:type="array">
                <item name="aw_delivery_date_from" xsi:type="string">sales_order.aw_delivery_date_from</item>
                <item name="aw_delivery_date_to" xsi:type="string">sales_order.aw_delivery_date_to</item>
                <item name="aw_delivery_date" xsi:type="string">sales_order.aw_delivery_date</item>
                <item name="aw_order_note" xsi:type="string">sales_order.aw_order_note</item>
            </argument>
        </arguments>
    </virtualType>
    <type name="Aheadworks\OneStepCheckout\Setup\Patch\Data\RefreshOrderGrid">
        <arguments>
            <argument name="entityGrid" xsi:type="object">Magento\Sales\Model\ResourceModel\Order\Grid</argument>
        </arguments>
    </type>
    <preference for="Aheadworks\OneStepCheckout\Model\Address\Form\GeoIp\AdapterInterface" type="Aheadworks\OneStepCheckout\Model\Address\Form\GeoIp\Adapter\GeoIp2" />

    <!-- Ui attribute component builders -->
    <virtualType name="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\VirtualUiComponentBuilder" type="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\UiComponentBuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="component" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Builder\Component</item>
                <item name="template" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Builder\Template</item>
                <item name="imports" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Builder\Imports</item>
                <item name="common" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Builder\Common</item>
                <item name="validation" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Builder\Validation</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Customer\VirtualUiComponentBuilder" type="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\VirtualUiComponentBuilder">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="customerSpecific" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Customer\Builder\CustomerSpecific</item>
                <item name="value" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Customer\Builder\Value</item>
            </argument>
        </arguments>
    </virtualType>
    <type name="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Customer\Merger">
        <arguments>
            <argument name="builder" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Customer\VirtualUiComponentBuilder</argument>
        </arguments>
    </type>

    <virtualType name="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Address\VirtualUiComponentBuilder" type="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\VirtualUiComponentBuilder">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="addressSpecific" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Address\Builder\AddressSpecific</item>
            </argument>
        </arguments>
    </virtualType>
    <type name="Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Address\Merger">
        <arguments>
            <argument name="builder" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Address\VirtualUiComponentBuilder</argument>
            <argument name="multiLineBuilder" xsi:type="object">Aheadworks\OneStepCheckout\Model\Layout\Processor\Attributes\Address\Builder\Multiline</argument>
        </arguments>
    </type>

    <!-- Payment data extension processors -->
    <type name="Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataExtensionProcessor">
        <arguments>
            <argument name="processors" xsi:type="array">
                <item name="deliveryDate" xsi:type="object">Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataProcessor\DeliveryDate</item>
                <item name="orderNote" xsi:type="object">Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataProcessor\Newsletter</item>
                <item name="newsletter" xsi:type="object">Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataProcessor\OrderNote</item>
                <item name="customerInfo" xsi:type="object">Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataProcessor\CustomerInfo</item>
                <item name="createAccountAfterCheckout" xsi:type="object">Aheadworks\OneStepCheckout\Model\Checkout\PaymentDataProcessor\CustomerAccount</item>
            </argument>
        </arguments>
    </type>

    <!-- Plugins -->
    <type name="Magento\SalesRule\Model\Quote\Discount">
        <plugin name="aw-osc-salesrule-quote-discount-plugin" type="Aheadworks\OneStepCheckout\Plugin\SalesRule\Model\Quote\DiscountPlugin"/>
    </type>

    <type name="Magento\Quote\Model\Quote\TotalsCollector">
        <plugin name="aw-quote-reward-amount-updater" type="Aheadworks\OneStepCheckout\Plugin\Quote\TotalsCollector" />
    </type>
    <type name="Magento\Quote\Model\Cart\Totals\ItemConverter">
        <plugin name="aw-osc-cart-item-converter-plugin" type="Aheadworks\OneStepCheckout\Plugin\Quote\Model\Cart\Totals\ItemConverterPlugin"/>
    </type>

    <type name="Aheadworks\OneStepCheckout\Model\Config">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Backend\ConfigValue">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Backend\Customization">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Backend\DeliveryDate\NonDeliveryPeriod">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Backend\DeliveryDate\TimeSlot">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Backend\TrustSeals\Badges">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>
    <type name="Aheadworks\OneStepCheckout\Model\Config\Initial\Exploder">
        <arguments>
            <argument name="serializer" xsi:type="object">Magento\Framework\Serialize\Serializer\Serialize</argument>
        </arguments>
    </type>

    <virtualType name="Aheadworks\OneStepCheckout\Model\Address\Form\AttributeMeta\Modifier\Attribute\Prefix"
                 type="Aheadworks\OneStepCheckout\Model\Address\Form\AttributeMeta\Modifier\Attribute\PrefixSuffix">
        <arguments>
            <argument name="attributeCode" xsi:type="string">prefix</argument>
        </arguments>
    </virtualType>
    <virtualType name="Aheadworks\OneStepCheckout\Model\Address\Form\AttributeMeta\Modifier\Attribute\Suffix"
                 type="Aheadworks\OneStepCheckout\Model\Address\Form\AttributeMeta\Modifier\Attribute\PrefixSuffix">
        <arguments>
            <argument name="attributeCode" xsi:type="string">suffix</argument>
        </arguments>
    </virtualType>

    <type name="Aheadworks\OneStepCheckout\Model\Address\Attribute\Code\Resolver">
        <arguments>
            <argument name="fieldsDuplicationMap" xsi:type="array">
                <item name="region" xsi:type="string">region_id</item>
            </argument>
        </arguments>
    </type>

    <!-- Increase limit up to 50 to make checkout field completeness logger work correctly -->
    <type name="Magento\Framework\Webapi\Validator\EntityArrayValidator">
        <arguments>
            <argument name="complexArrayItemLimit" xsi:type="number">50</argument>
        </arguments>
    </type>
</config>
